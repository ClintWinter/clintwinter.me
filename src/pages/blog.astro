---
interface Frontmatter {
    title: string;
    publishedAt?: string;
}

import { DateTime } from "luxon";
import MainLayout from "../layouts/MainLayout.astro";
import OrnamentDivider from "../components/OrnamentDivider.astro";
import PostRow from "../components/PostRow.astro";
import { guessDateFormat } from "../utils/dates";

const posts = Object.values(
    import.meta.glob<{ frontmatter: Frontmatter; url: string }>('./blog/*.md', { eager: true })
)
    .filter((post) => post.frontmatter.publishedAt)
    .sort((a, b) => new Date(b.frontmatter.publishedAt!).getTime() - new Date(a.frontmatter.publishedAt!).getTime());
---

<MainLayout title="Clint Winter | Musings" backHref="/" backText="← Return Home" navBorder={false}>
    <header class="mb-8 text-center">
        <h1 class="font-heading text-4xl font-bold mb-2 text-burgundy">Musings</h1>
        <p class="font-body text-xl italic text-muted">Notes on building software</p>
    </header>

    <OrnamentDivider ornament="✦" />

    <ul class="font-body">
        {posts.map((post, i) => (
            <li>
                <PostRow
                    href={post.url}
                    date={guessDateFormat(post.frontmatter.publishedAt!).toLocaleString(DateTime.DATE_MED)}
                    class="py-4"
                >
                    {post.frontmatter.title}
                </PostRow>
                {i < posts.length - 1 && (
                    <div class="h-px bg-gradient-to-r from-transparent via-tan to-transparent"></div>
                )}
            </li>
        ))}
    </ul>

    <OrnamentDivider ornament="⁂" />
</MainLayout>
